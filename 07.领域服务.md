# 第七章、领域服务

## 一、什么是领域服务

当领域中的某个操作过程或转换过程不是实体或值对象的职责时，多们便应该将该操作放在一个单独的接口中，这个接口就是领域服务。



**怎么判断一个操作不属于实体或者值对象呢？**

1. 执行一个显著的业务操作过程。
2. 对领域对象进行转换。
3. 以多个领域对象作为输入进行计算，结果产生一个值对象。



**我的判断标准**

1. 事务性的、不适合覆写的操作，比如说累加、累减
2. 复杂的涉及多个实体参与的操作过程，这里很容易分清楚，发起者一般都是用户、系统，绝不是实体本身。
3. 内嵌与实体的大规模的Collection，比如说论坛中的版块和帖子，版块内包含帖子，但是帖子的数量极大，所以不能内嵌于版块中，所以涉及到版块查帖子的操作一般做成领域服务。
4. 实体、值对象这类的，一般定义在上面的方法都是针对自己的属性修改的。如果发现方法内也对实体、值对象进行变更、修改，那么这个方法就不能定义在实体、值对象上，而应该定义成领域服务。



## 二、一些思考

由于是分层架构，上层不能直接使用下层定义的组件，而下层只能使用上层定义好的需求组件。

这种情况下，我们再思考领域层与应用层的边界问题。

书中是没有提这个事情的，仅只是说一个不能作为实体操作的操作需做成领域服务，那么适合实体操作的就直接放在实体中了。

那么就存在一个问题，应用层和领域层的边界是什么？

应用层对于适合实体操作的调用，直接就使用实体吗？实体可是领域层的东西，按照上层不能直接使用下层定义的组件的原则，应用层是不能使用实体的。

所以，书本的逻辑是不对的。

上层和下层的通信是基于协议的，上层不能直接使用下层定义的组件。从这个意义上讲，上层和下层的通信是基于接口和ＤＴＯ进行通信的，所以应用层与领域层的通信是基于领域服务的。

那么实体中定义的方法呢？我们可以理解为领域服务调用实体的方法去实现领域服务的功能，领域服务是聚合实体方法的方式：有时只调用一个实体，有时则是多个实体配合。

> 仍然需要一个一些代码来讲这个概念，后面补上。
>
> 把ＤＤＤ的所有概念全都走完，然后总结一下，写个一example项目出来，分布式的。

